{"version":3,"file":"settings-page.js","mappings":"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","sources":["webpack://wsuwp-plugin-people-directory/../../../../../../../../../repos/wsu/wsuwp-plugin-people-directory/assets/src/settings-page.scss?6c34","webpack://wsuwp-plugin-people-directory/external window \"lodash\"","webpack://wsuwp-plugin-people-directory/webpack/bootstrap","webpack://wsuwp-plugin-people-directory/webpack/runtime/compat get default export","webpack://wsuwp-plugin-people-directory/webpack/runtime/define property getters","webpack://wsuwp-plugin-people-directory/webpack/runtime/hasOwnProperty shorthand","webpack://wsuwp-plugin-people-directory/webpack/runtime/make namespace object","webpack://wsuwp-plugin-people-directory/../../../../../../../../../repos/wsu/wsuwp-plugin-people-directory/assets/src/settings-page.js"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport {};","module.exports = window[\"lodash\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import \"./settings-page.scss\";\nimport { bind, create, groupBy } from \"lodash\";\n\njQuery(document).ready(function () {\n    (function ($) {\n        const settingsPageBody = $(\".settings_page_people_directory\");\n        const notice = settingsPageBody.find(\".notice\");\n        const noticeMessage = notice.find(\".message\");\n        const orgSelectControl = $(\"#university-org-select\");\n        const createFormToggle = $(\"#university-org-create-toggle\");\n        const createForm = $(\"#university-org-create-form\");\n        const formFields = {\n            tagName: createForm.find(\"#tag-name\"),\n            tagSlug: createForm.find(\"#tag-slug\"),\n            tagParent: createForm.find(\"#parent\"),\n            tagDescription: createForm.find(\"#tag-description\"),\n        };\n        const importProfilesButton = $(\"#import-profiles-btn\");\n        const profileNidsTextarea = $(\"#profile-nids\");\n\n        const apiEndpoint = window.location.hostname.includes(\".local\")\n            ? \"http://peopleapi.local/wp-json/peopleapi/v1/\"\n            : \"https://people.wsu.edu/wp-json/peopleapi/v1/\";\n        let groupedOrgs;\n\n        const notificationClasses = {\n            error: \"notice-error notice-alt\",\n            success: \"notice-success\",\n        };\n\n        function buildOptionsString(options, value = \"\", space = \"\") {\n            const currentOrg = orgSelectControl.attr(\"data-value\");\n\n            options.forEach((option) => {\n                value += `<option value=\"${option.slug}\" ${\n                    currentOrg === option.slug && \"selected\"\n                }>${space.replace(/ /g, \"\\u00a0\") + option.name}</option>`;\n\n                if (groupedOrgs[option.term_id]) {\n                    value = buildOptionsString(\n                        groupedOrgs[option.term_id],\n                        value,\n                        space + \"   \"\n                    );\n                }\n            });\n\n            return value;\n        }\n\n        function showNotification(type, message) {\n            notice.removeClass(\"hidden\");\n            notice.addClass(notificationClasses[type]);\n            noticeMessage.text(message);\n        }\n\n        function resetNotification(notification) {\n            notification.addClass(\"hidden\");\n            notification.removeClass(\"notice-error notice-alt notice-success\");\n            noticeMessage.text(\"\");\n        }\n\n        async function updateOrgSelectControls() {\n            const response = await fetch(\n                apiEndpoint + \"get-all-terms?taxonomy=wsuwp_university_org\"\n            );\n\n            if (response.ok) {\n                const data = await response.json();\n\n                if (Array.isArray(data)) {\n                    groupedOrgs = groupBy(data, \"parent\");\n                    const optionsString = buildOptionsString(groupedOrgs[0]);\n                    orgSelectControl.append(optionsString);\n                    formFields.tagParent.append(optionsString);\n                }\n            }\n        }\n\n        async function submitCreateForm(e) {\n            resetNotification(notice);\n\n            const response = await fetch(apiEndpoint + \"create-organization\", {\n                method: \"POST\",\n                mode: \"cors\",\n                cache: \"no-cache\",\n                body: new URLSearchParams({\n                    tag_name: formFields.tagName.val(),\n                    tag_slug: formFields.tagSlug.val(),\n                    tag_parent: formFields.tagParent.val(),\n                    tag_description: formFields.tagDescription.val(),\n                }),\n            });\n            const data = await response.json();\n\n            if (!response.ok) {\n                showNotification(\"error\", data.message);\n                return;\n            }\n\n            // update opptions\n            orgSelectControl.attr(\"data-value\", data.slug);\n            updateOrgSelectControls();\n\n            // reset\n            formFields.tagName.val(\"\");\n            formFields.tagSlug.val(\"\");\n            formFields.tagDescription.val(\"\");\n            createForm.hide();\n        }\n\n        async function importProfiles(e) {\n            const nids = profileNidsTextarea\n                .val()\n                .split(\"\\n\")\n                .map((e) => e.trim())\n                .join(\"\\\\n\");\n\n            resetNotification(notice);\n\n            if (nids.trim() !== \"\") {\n                const response = await fetch(\n                    \"/wp-json/people-directory-api/v1/import-profiles\",\n                    {\n                        method: \"POST\",\n                        body: new URLSearchParams({\n                            nids: nids,\n                        }),\n                    }\n                );\n\n                if (response.ok) {\n                    const data = await response.json();\n                    profileNidsTextarea.val(\"\");\n                    showNotification(\"success\", data.message);\n                } else {\n                    const data = await response.json();\n                    showNotification(\"error\", data.message);\n                }\n            } else {\n                showNotification(\"error\", \"The nids field cannot be empty.\");\n            }\n        }\n\n        function bindEvents() {\n            createFormToggle.on(\"click\", function (e) {\n                createForm.show();\n                return false;\n            });\n\n            createForm.find(\"#submit\").on(\"click\", submitCreateForm);\n\n            importProfilesButton.on(\"click\", importProfiles);\n        }\n\n        function init() {\n            updateOrgSelectControls();\n            bindEvents();\n        }\n\n        init();\n    })(jQuery);\n});\n"],"names":["bind","create","groupBy","jQuery","document","ready","$","settingsPageBody","notice","find","noticeMessage","orgSelectControl","createFormToggle","createForm","formFields","tagName","tagSlug","tagParent","tagDescription","importProfilesButton","profileNidsTextarea","apiEndpoint","window","location","hostname","includes","groupedOrgs","notificationClasses","error","success","buildOptionsString","options","value","space","currentOrg","attr","forEach","option","slug","replace","name","term_id","showNotification","type","message","removeClass","addClass","text","resetNotification","notification","updateOrgSelectControls","response","fetch","ok","data","json","Array","isArray","optionsString","append","submitCreateForm","e","method","mode","cache","body","URLSearchParams","tag_name","val","tag_slug","tag_parent","tag_description","hide","importProfiles","nids","split","map","trim","join","bindEvents","on","show","init"],"sourceRoot":""}