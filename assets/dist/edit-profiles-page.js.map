{"version":3,"file":"edit-profiles-page.js","mappings":"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","sources":["webpack://wsuwp-plugin-people-directory/../../../../../../../../../repos/wsu/wsuwp-plugin-people-directory/assets/src/edit-profiles-page.scss?1d80","webpack://wsuwp-plugin-people-directory/webpack/bootstrap","webpack://wsuwp-plugin-people-directory/webpack/runtime/make namespace object","webpack://wsuwp-plugin-people-directory/../../../../../../../../../repos/wsu/wsuwp-plugin-people-directory/assets/src/edit-profiles-page.js"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport {};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import \"./edit-profiles-page.scss\";\n\njQuery(document).ready(function () {\n    (function ($) {\n        const addNewButton = $(\".wrap .page-title-action\").first();\n        const importModalButton = $(\n            '<button class=\"page-title-action\">Import WSU Profiles</button>'\n        );\n        const modalContainerPlaceholder = $(\n            `<div id=\"edit-profiles-page-modal-placeholder\" style=\"display:none;\"></div>`\n        );\n        const modalContent = `\n            <div class=\"form-wrap edit-profiles-page-modal\">\n                <div class=\"notice notice-error notice-alt inline hidden\">\n                    <p class=\"error\"></p>\n                </div>\n                <div class=\"form-field\">\n                    <label for=\"profile-nids\">List profile nids to import. One per line.</label>\n                    <textarea id=\"profile-nids\" class=\"profile-nids\" rows=\"5\" placeholder=\"butch.cougar\"></textarea>\n                </div>\n                <p class=\"submit\">\n                    <button type=\"button\" name=\"submit\" id=\"submit\" class=\"button button-primary\">Import Profiles</button>\n                    <span class=\"spinner\"></span>\n                </p>\n            </div>`;\n        let modalContainer;\n\n        function injectModalContent(container, content) {\n            container.html(content);\n            $(document.body).append(container);\n        }\n\n        function injectImportButton(btn) {\n            addNewButton.after(btn);\n        }\n\n        async function submitImportForm(e) {\n            const spinner = modalContainer.find(\".spinner\");\n            const notice = modalContainer.find(\".notice\");\n            const noticeMessage = modalContainer.find(\".error\");\n            const submitButton = modalContainer.find(\"#submit\");\n\n            const profileNidsTextarea = modalContainer.find(\"#profile-nids\");\n            const nids = profileNidsTextarea\n                .val()\n                .split(\"\\n\")\n                .map((e) => e.trim())\n                .join(\"\\\\n\");\n\n            notice.addClass(\"hidden\");\n            noticeMessage.text(\"\");\n\n            if (nids.trim() !== \"\") {\n                spinner.addClass(\"is-active\");\n                submitButton.prop(\"disabled\", true);\n\n                const response = await fetch(\n                    \"/wp-json/people-directory-api/v1/import-profiles\",\n                    {\n                        method: \"POST\",\n                        body: new URLSearchParams({\n                            nids: nids,\n                        }),\n                    }\n                );\n\n                if (response.ok) {\n                    profileNidsTextarea.val(\"\");\n                    location.reload();\n                } else {\n                    const data = await response.json();\n                    spinner.removeClass(\"is-active\");\n                    notice.removeClass(\"hidden\");\n                    noticeMessage.text(data.message);\n\n                    submitButton.prop(\"disabled\", false);\n                }\n            } else {\n                notice.removeClass(\"hidden\");\n                noticeMessage.text(\"The nids field cannot be empty.\");\n                submitButton.prop(\"disabled\", false);\n            }\n        }\n\n        function bindEvents() {\n            importModalButton.on(\"click\", function (e) {\n                tb_show(\n                    \"Import WSU Profiles\",\n                    \"#TB_inline?inlineId=edit-profiles-page-modal-placeholder&width=300\"\n                );\n\n                modalContainer = $(\".edit-profiles-page-modal\").first();\n                modalContainer.find(\"#submit\").on(\"click\", submitImportForm);\n                checkOrgSetting();\n            });\n        }\n\n        function checkOrgSetting() {\n            const notice = modalContainer.find(\".notice\");\n            const noticeMessage = modalContainer.find(\".error\");\n            const submitButton = modalContainer.find(\"#submit\");\n\n            notice.addClass(\"hidden\");\n            noticeMessage.html(\"\");\n\n            if (!editProfilePageData.universityOrganization) {\n                notice.removeClass(\"hidden\");\n                noticeMessage.html(\n                    `An organization slug must be selected on the <a href=\"/wp-admin/options-general.php?page=people_directory\">People Directory settings page</a> before importing profiles.`\n                );\n\n                submitButton.prop(\"disabled\", true);\n            }\n        }\n\n        function init() {\n            injectModalContent(modalContainerPlaceholder, modalContent);\n            injectImportButton(importModalButton);\n            bindEvents();\n        }\n\n        init();\n    })(jQuery);\n});\n"],"names":["jQuery","document","ready","$","addNewButton","first","importModalButton","modalContainerPlaceholder","modalContent","modalContainer","injectModalContent","container","content","html","body","append","injectImportButton","btn","after","submitImportForm","e","spinner","find","notice","noticeMessage","submitButton","profileNidsTextarea","nids","val","split","map","trim","join","addClass","text","prop","response","fetch","method","URLSearchParams","ok","location","reload","data","json","removeClass","message","bindEvents","on","tb_show","checkOrgSetting","editProfilePageData","universityOrganization","init"],"sourceRoot":""}