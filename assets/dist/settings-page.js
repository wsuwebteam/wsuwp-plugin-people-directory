!function(){"use strict";var e=window.lodash;jQuery(document).ready((function(){!function(t){const a=t(".settings_page_people_directory").find(".notice"),n=a.find(".message"),o=t("#university-org-select"),i=t("#university-org-create-toggle"),s=t("#university-org-create-form"),r={tagName:s.find("#tag-name"),tagSlug:s.find("#tag-slug"),tagParent:s.find("#parent"),tagDescription:s.find("#tag-description")},c=t("#import-profiles-btn"),l=t("#profile-nids"),p=window.location.hostname.includes(".local")?"http://peopleapi.local/wp-json/peopleapi/v1/":"https://people.wsu.edu/wp-json/peopleapi/v1/";let d;const g={error:"notice-error notice-alt",success:"notice-success"};function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const n=o.attr("data-value");return e.forEach((e=>{t+=`<option value="${e.slug}" ${n===e.slug&&"selected"}>${a.replace(/ /g,"Â ")+e.name}</option>`,d[e.term_id]&&(t=u(d[e.term_id],t,a+"   "))})),t}function m(e,t){a.removeClass("hidden"),a.addClass(g[e]),n.text(t)}function f(e){e.addClass("hidden"),e.removeClass("notice-error notice-alt notice-success"),n.text("")}async function v(){const t=await fetch(p+"get-all-terms?taxonomy=wsuwp_university_org");if(t.ok){const a=await t.json();if(Array.isArray(a)){d=(0,e.groupBy)(a,"parent");const t=u(d[0]);o.append(t),r.tagParent.append(t)}}}v(),i.on("click",(function(e){return s.show(),!1})),s.find("#submit").on("click",(async function(e){f(a);const t=await fetch(p+"create-organization",{method:"POST",mode:"cors",cache:"no-cache",body:new URLSearchParams({tag_name:r.tagName.val(),tag_slug:r.tagSlug.val(),tag_parent:r.tagParent.val(),tag_description:r.tagDescription.val()})}),n=await t.json();t.ok?(o.attr("data-value",n.slug),v(),r.tagName.val(""),r.tagSlug.val(""),r.tagDescription.val(""),s.hide()):m("error",n.message)})),c.on("click",(async function(e){const t=l.val().split("\n").map((e=>e.trim())).join("\\n");if(f(a),""!==t.trim()){const e=await fetch("/wp-json/people-directory-api/v1/import-profiles",{method:"POST",body:new URLSearchParams({nids:t})});if(e.ok){const t=await e.json();l.val(""),m("success",t.message)}else m("error",(await e.json()).message)}else m("error","The nids field cannot be empty.")}))}(jQuery)}))}();