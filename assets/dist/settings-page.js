!function(){"use strict";var e=window.lodash;jQuery(document).ready((function(){!function(t){const a=t(".settings_page_people_directory").find(".notice"),n=a.find(".message"),i=t("#university-org-select"),o=t("#university-org-create-toggle"),s=t("#university-org-create-form"),r={tagName:s.find("#tag-name"),tagSlug:s.find("#tag-slug"),tagParent:s.find("#parent"),tagDescription:s.find("#tag-description")},c=t("#list-profiles-btn"),l=t("#import-profiles-btn"),p=t(".wsu-import-submit__container .spinner"),d=t("#profile-nids"),u=t("#unpublish-profiles"),g=window.location.hostname.includes(".local")?"http://peopleapi.local/wp-json/peopleapi/v1/":"https://people.wsu.edu/wp-json/peopleapi/v1/";let f;const m={error:"notice-error notice-alt",success:"notice-success"};function v(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const n=i.attr("data-value");return e.forEach((e=>{t+=`<option value="${e.slug}" ${n===e.slug&&"selected"}>${a.replace(/ /g,"Â ")+e.name}</option>`,f[e.term_id]&&(t=v(f[e.term_id],t,a+"   "))})),t}function h(e,t){a.removeClass("hidden"),a.addClass(m[e]),n.text(t)}function w(e){e.addClass("hidden"),e.removeClass("notice-error notice-alt notice-success"),n.text("")}async function y(){const t=await fetch(g+"get-all-terms?taxonomy=wsuwp_university_org");if(t.ok){const a=await t.json();if(Array.isArray(a)){f=(0,e.groupBy)(a,"parent");const t=v(f[0]);i.append(t),r.tagParent.append(t)}}}y(),o.on("click",(function(e){return s.show(),!1})),s.find("#submit").on("click",(async function(e){w(a);const t=await fetch(g+"create-organization",{method:"POST",mode:"cors",cache:"no-cache",body:new URLSearchParams({tag_name:r.tagName.val(),tag_slug:r.tagSlug.val(),tag_parent:r.tagParent.val(),tag_description:r.tagDescription.val()})}),n=await t.json();t.ok?(i.attr("data-value",n.slug),y(),r.tagName.val(""),r.tagSlug.val(""),r.tagDescription.val(""),s.hide()):h("error",n.message)})),l.on("click",(async function(e){const t=d.val().split("\n").map((e=>e.trim())).join("\\n"),n=u.is(":checked");if(w(a),""!==t.trim()){l.prop("disabled",!0),p.addClass("is-active");const e=await fetch(SETTINGS_PAGE_DATA.siteUrl+"/wp-json/people-directory-api/v1/import-profiles",{method:"POST",body:new URLSearchParams({nids:t,unpublishProfiles:n})});if(e.ok){const t=await e.json();d.val(""),h("success",t.message)}else h("error",(await e.json()).message)}else h("error","The nids field cannot be empty.");l.prop("disabled",!1),p.removeClass("is-active")})),c.on("click",(function(e){window.location.href+=(window.location.href.indexOf("?")>-1?"&":"?")+"list-profiles=true"}))}(jQuery)}))}();